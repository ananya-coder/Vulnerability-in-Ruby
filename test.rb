require 'sqlite3'

# Create a new SQLite database in memory
db = SQLite3::Database.new(':memory:')

# Create a users table
db.execute <<-SQL
  CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL,
    password TEXT NOT NULL
  );
SQL

# Insert a user into the database
db.execute("INSERT INTO users (username, password) VALUES ('user', 'password')")

# Simulation of a vulnerable login system
def login(username, password, db)
  sql_query = "SELECT * FROM users WHERE username='#{username}' AND password='#{password}'"
  result = db.execute(sql_query)
  result.empty? ? "Login failed" : "Login successful"
end

# Simulate an injection attack
injection_username = "' OR '1'='1"
injection_password = "' OR '1'='1"
puts login(injection_username, injection_password, db)

