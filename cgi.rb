require 'cgi'

# User input (simulating untrusted input)
user_input = "\r\nSet-Cookie: malicious_cookie=malicious_value"

# Generate HTTP response using CGI with user input
response = "Content-Type: text/html\r\n\r\n"
response += "<html><body>Hello, World!</body></html>"
response_with_user_input = response + user_input

# Output the manipulated response
puts "Manipulated Response:"
puts response_with_user_input

# Parse the manipulated response using CGI
cgi = CGI.new
parsed_params = cgi.parse(response_with_user_input)

# Output parsed parameters
puts "\nParsed Parameters:"
parsed_params.each do |key, value|
  puts "#{key}: #{value.join(', ')}"
end
